angular.module("dialogs.controllers",["ui.bootstrap.modal","pascalprecht.translate"]).config(["$translateProvider",function($translateProvider){$translateProvider.translations("en-US",{DIALOGS_ERROR:"Error",DIALOGS_ERROR_MSG:"An unknown error has occurred.",DIALOGS_CLOSE:"Close",DIALOGS_PLEASE_WAIT:"Please Wait",DIALOGS_PLEASE_WAIT_ELIPS:"Please Wait...",DIALOGS_PLEASE_WAIT_MSG:"Waiting on operation to complete.",DIALOGS_PERCENT_COMPLETE:"% Complete",DIALOGS_NOTIFICATION:"Notification",DIALOGS_NOTIFICATION_MSG:"Unknown application notification.",DIALOGS_CONFIRMATION:"Confirmation",DIALOGS_CONFIRMATION_MSG:"Confirmation required.",DIALOGS_OK:"OK",DIALOGS_YES:"Yes",DIALOGS_NO:"No"}),$translateProvider.preferredLanguage("en-US")}]).controller("errorDialogCtrl",["$scope","$modalInstance","$translate","header","msg",function($scope,$modalInstance,$translate,header,msg){$scope.header=angular.isDefined(header)?header:$translate.instant("DIALOGS_ERROR"),$scope.msg=angular.isDefined(msg)?msg:$translate.instant("DIALOGS_ERROR_MSG"),$scope.close=function(){$modalInstance.close(),$scope.$destroy()}}]).controller("waitDialogCtrl",["$scope","$modalInstance","$translate","$timeout","header","msg","progress",function($scope,$modalInstance,$translate,$timeout,header,msg,progress){$scope.header=angular.isDefined(header)?header:$translate.instant("DIALOGS_PLEASE_WAIT_ELIPS"),$scope.msg=angular.isDefined(msg)?msg:$translate.instant("DIALOGS_PLEASE_WAIT_MSG"),$scope.progress=angular.isDefined(progress)?progress:100,$scope.$on("dialogs.wait.complete",function(){$timeout(function(){$modalInstance.close(),$scope.$destroy()})}),$scope.$on("dialogs.wait.message",function(evt,args){$scope.msg=angular.isDefined(args.msg)?args.msg:$scope.msg}),$scope.$on("dialogs.wait.progress",function(evt,args){$scope.msg=angular.isDefined(args.msg)?args.msg:$scope.msg,$scope.progress=angular.isDefined(args.progress)?args.progress:$scope.progress}),$scope.getProgress=function(){return{width:$scope.progress+"%"}}}]).controller("notifyDialogCtrl",["$scope","$modalInstance","$translate","header","msg",function($scope,$modalInstance,$translate,header,msg){$scope.header=angular.isDefined(header)?header:$translate.instant("DIALOGS_NOTIFICATION"),$scope.msg=angular.isDefined(msg)?msg:$translate.instant("DIALOGS_NOTIFICATION_MSG"),$scope.close=function(){$modalInstance.close(),$scope.$destroy()}}]).controller("confirmDialogCtrl",["$scope","$modalInstance","$translate","header","msg",function($scope,$modalInstance,$translate,header,msg){$scope.header=angular.isDefined(header)?header:$translate.instant("DIALOGS_CONFIRMATION"),$scope.msg=angular.isDefined(msg)?msg:$translate.instant("DIALOGS_CONFIRMATION_MSG"),$scope.no=function(){$modalInstance.dismiss("no")},$scope.yes=function(){$modalInstance.close("yes")}}]),angular.module("dialogs.services",["ui.bootstrap.modal","dialogs.controllers"]).provider("dialogs",[function(){var _b=!0,_k=!0,_w="dialogs-default",_copy=!0,_wTmpl=null,_wSize="lg",_setOpts=function(opts){var _opts={};return opts=angular.isDefined(opts)?opts:{},_opts.kb=angular.isDefined(opts.keyboard)?opts.keyboard:_k,_opts.bd=angular.isDefined(opts.backdrop)?opts.backdrop:_b,_opts.ws=angular.isDefined(opts.size)&&(angular.equals(opts.size,"sm")||angular.equals(opts.size,"lg"))?opts.size:_wSize,_opts.wc=angular.isDefined(opts.windowClass)?opts.windowClass:_w,_opts};this.useBackdrop=function(val){angular.isDefined(val)&&(_b=val)},this.useEscClose=function(val){angular.isDefined(val)&&(_k=angular.equals(val,0)||angular.equals(val,"false")||angular.equals(val,"no")||angular.equals(val,null)||angular.equals(val,!1)?!1:!0)},this.useClass=function(val){angular.isDefined(val)&&(_w=val)},this.useCopy=function(val){angular.isDefined(val)&&(_copy=angular.equals(val,0)||angular.equals(val,"false")||angular.equals(val,"no")||angular.equals(val,null)||angular.equals(val,!1)?!1:!0)},this.setWindowTmpl=function(val){angular.isDefined(val)&&(_wTmpl=val)},this.setSize=function(val){angular.isDefined(val)&&(_wSize=angular.equals(val,"sm")||angular.equals(val,"lg")?val:_wSize)},this.$get=["$modal",function($modal){return{error:function(header,msg,opts){return opts=_setOpts(opts),$modal.open({templateUrl:"/dialogs/error.html",controller:"errorDialogCtrl",backdrop:opts.bd,keyboard:opts.kb,windowClass:opts.wc,size:opts.ws,resolve:{header:function(){return angular.copy(header)},msg:function(){return angular.copy(msg)}}})},wait:function(header,msg,progress,opts){return opts=_setOpts(opts),$modal.open({templateUrl:"/dialogs/wait.html",controller:"waitDialogCtrl",backdrop:opts.bd,keyboard:opts.kb,windowClass:opts.wc,size:opts.ws,resolve:{header:function(){return angular.copy(header)},msg:function(){return angular.copy(msg)},progress:function(){return angular.copy(progress)}}})},notify:function(header,msg,opts){return opts=_setOpts(opts),$modal.open({templateUrl:"/dialogs/notify.html",controller:"notifyDialogCtrl",backdrop:opts.bd,keyboard:opts.kb,windowClass:opts.wc,size:opts.ws,resolve:{header:function(){return angular.copy(header)},msg:function(){return angular.copy(msg)}}})},confirm:function(header,msg,opts){return opts=_setOpts(opts),$modal.open({templateUrl:"/dialogs/confirm.html",controller:"confirmDialogCtrl",backdrop:opts.bd,keyboard:opts.kb,windowClass:opts.wc,size:opts.ws,resolve:{header:function(){return angular.copy(header)},msg:function(){return angular.copy(msg)}}})},create:function(url,ctrlr,data,opts){var copy=angular.isDefined(opts)&&angular.isDefined(opts.copy)?opts.copy:_copy;return opts=_setOpts(opts),$modal.open({templateUrl:url,controller:ctrlr,keyboard:opts.kb,backdrop:opts.bd,windowClass:opts.wc,size:opts.ws,resolve:{data:function(){return copy?angular.copy(data):data}}})}}}]}]),angular.module("dialogs.main",["dialogs.services","ngSanitize"]).run(["$templateCache","$interpolate",function($templateCache,$interpolate){var startSym=$interpolate.startSymbol(),endSym=$interpolate.endSymbol();$templateCache.put("/dialogs/error.html",'<div class="modal-header dialog-header-error"><button type="button" class="close" ng-click="close()">&times;</button><h4 class="modal-title text-danger"><span class="glyphicon glyphicon-warning-sign"></span> <span ng-bind-html="header"></span></h4></div><div class="modal-body text-danger" ng-bind-html="msg"></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="close()">'+startSym+'"DIALOGS_CLOSE" | translate'+endSym+"</button></div>"),$templateCache.put("/dialogs/wait.html",'<div class="modal-header dialog-header-wait"><h4 class="modal-title"><span class="glyphicon glyphicon-time"></span> '+startSym+'"DIALOGS_PLEASE_WAIT" | translate'+endSym+'</h4></div><div class="modal-body"><p ng-bind-html="msg"></p><div class="progress progress-striped active"><div class="progress-bar progress-bar-info" ng-style="getProgress()"></div><span class="sr-only">'+startSym+"progress"+endSym+startSym+'"DIALOGS_PERCENT_COMPLETE" | translate'+endSym+"</span></div></div>"),$templateCache.put("/dialogs/notify.html",'<div class="modal-header dialog-header-notify"><button type="button" class="close" ng-click="close()" class="pull-right">&times;</button><h4 class="modal-title text-info"><span class="glyphicon glyphicon-info-sign"></span> '+startSym+"header"+endSym+'</h4></div><div class="modal-body text-info" ng-bind-html="msg"></div><div class="modal-footer"><button type="button" class="btn btn-primary" ng-click="close()">'+startSym+'"DIALOGS_OK" | translate'+endSym+"</button></div>"),$templateCache.put("/dialogs/confirm.html",'<div class="modal-header dialog-header-confirm"><button type="button" class="close" ng-click="no()">&times;</button><h4 class="modal-title"><span class="glyphicon glyphicon-check"></span> '+startSym+"header"+endSym+'</h4></div><div class="modal-body" ng-bind-html="msg"></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="yes()">'+startSym+'"DIALOGS_YES" | translate'+endSym+'</button><button type="button" class="btn btn-primary" ng-click="no()">'+startSym+'"DIALOGS_NO" | translate'+endSym+"</button></div>")}]),angular.module("ThreeSixtyOneView.services",["dialogs.main","ThreeSixtyOneView.filters"]),angular.module("ThreeSixtyOneView.directives",["ThreeSixtyOneView.services"]),angular.module("ThreeSixtyOneView.filters",[]),angular.module("ThreeSixtyOneView.config",[]),angular.module("ThreeSixtyOneView",["ngResource","ngSanitize","ngRoute","ngAnimate","ui.bootstrap","dialogs.main","ThreeSixtyOneView.directives","ThreeSixtyOneView.services","ThreeSixtyOneView.config"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/",{templateUrl:"views/display_manager.tpl.html",controller:"ManagerCtrl",viewName:"ProjectManager"}).when("/scenarioEdit/:project/:scenario",{templateUrl:"views/scenario_edit.tpl.html",controller:"ScenarioEditCtrl"}).when("/scenarioCreate/:projectName/:scenarioName",{templateUrl:"views/scenario_create.tpl.html",controller:"ScenarioCreateCtrl"}).when("/projects",{templateUrl:"views/display_manager.tpl.html",controller:"ManagerCtrl",viewName:"ProjectManager"}).when("/dashboard/:projectName",{templateUrl:"views/display_manager.tpl.html",controller:"ManagerCtrl",viewName:"Dashboard"}).otherwise({redirectTo:"/"})}]).config(function(){String.prototype.bool=function(){return/^true$/i.test(this)}}).run(["FavoritesModel","ProjectsModel",function(FavoritesModel,ProjectsModel){ProjectsModel.find(),FavoritesModel.find()}]),angular.module("ThreeSixtyOneView").controller("MainCtrl",["$scope","SortAndFilterService","FileDeleteService","ActiveSelection","InfoTrayService","DiaglogService","FavoritesService","ViewService",function($scope,SortAndFilterService,FileDeleteService,ActiveSelection,InfoTrayService,DiaglogService,FavoritesService,ViewService){$scope.SortAndFilterService=SortAndFilterService,$scope.FileDeleteService=FileDeleteService,$scope.ActiveSelection=ActiveSelection,$scope.InfoTrayService=InfoTrayService,$scope.DiaglogService=DiaglogService,$scope.FavoritesService=FavoritesService,$scope.ViewService=ViewService,$scope.console=function(msg){console.info(msg)},$scope.alert=function(msg,evt){window.alert(msg),evt&&evt.stopPropagation()}}]).controller("ManagerCtrl",["$scope","$injector","$location","$routeParams","CONFIG","Urlmaker","FavoritesModel","FavoritesService","ViewService",function($scope,$injector,$location,$routeParams,CONFIG,Urlmaker,FavoritesModel,FavoritesService,ViewService){var currentView=CONFIG.view[ViewService.getCurrentView()],currentModel=currentView.model,filter="",viewModel,filter=eval(currentView.filter),reverse=currentView.reverse,orderBy=currentView.orderBy,gotoDashboard=function(item){Urlmaker.makeUrl("dashboard",item.title)},gotoScenarioEdit=function(item){Urlmaker.makeUrl("scenarioEdit",$scope.CONFIG.projectName,item)},gotoProjects=function(){Urlmaker.makeUrl("projects")},init=function(){$scope.data={},$scope.CONFIG={},$scope.CONFIG.hasFavorites=currentView.favorites,$scope.CONFIG.topInclude=currentView.topInclude||!1,$scope.CONFIG.status=currentView.status||!1,$scope.CONFIG.projectName=$routeParams.projectName,$scope.CONFIG.menuItems=currentView.filterMenu,$scope.CONFIG.displayActionsCreate=currentView.displayActionsCreate,$scope.CONFIG.currentView={},$scope.CONFIG.currentView.where=currentView.where,console.info(currentView),console.info($scope.CONFIG),currentModel&&(viewModel=$injector.get(currentModel)),viewModel?(viewModel.get().then(function(response){if($scope.data=response,$scope.SortAndFilterService.init({data:response,orderBy:orderBy,filter:filter,reverse:reverse}),$scope.CONFIG.hasFavorites){var master;_.each($scope.data,function(element){master=_.find(element,function(elem){return elem.isMaster})}),FavoritesModel.get().then(function(response){FavoritesService.setFavorites(_.pluck(response,"uuid")),FavoritesService.addFavorite(master.id)})}}),ViewService.setModel(viewModel)):console.info("no view model"),"Dashboard"===ViewService.getCurrentView()&&($scope.CONFIG.hasAlerts=!0,$scope.alertSrc="views/includes/alert.tpl.html")};init(),$scope.goto=function(where,item,evt){switch(evt.stopPropagation(),where){case"gotoScenarioEdit":gotoScenarioEdit(item);break;case"gotoDashboard":gotoDashboard(item);break;case"gotoProjects":gotoProjects()}},$scope.$on("CreateCtrl:create",function(event,data){Urlmaker.makeUrl("scenarioCreate",$scope.CONFIG.projectName,data.name)}),$scope.$on("ProjectCreateCtrl:create",function(event,data){Urlmaker.makeUrl("dashboard",data)})}]).controller("InfoTrayCtrl",["$scope",function($scope){$scope.selectedItem=$scope.ActiveSelection.getActiveItem(),$scope.seeAll=!1,$scope.$on("ActiveSelection:activeItemChange",function(event,response){""!==response.data&&($scope.selectedItem=response.data)})}]).controller("ScenarioEditCtrl",["$scope","$routeParams","Urlmaker",function($scope,$routeParams,Urlmaker){$scope.projectName=$routeParams.project,$scope.entity=$routeParams.entity,$scope.types=["Marketing Plan","Cost Assumptions"," Enviromental Factores","Economica Variables","Pricing Factors","Brand Factors"],$scope.scenarioElementType=$scope.types[0],$scope.backToProject=function(project){Urlmaker.makeUrl("dashboard",project)}}]).controller("ScenarioCreateCtrl",["$scope","$routeParams","Urlmaker",function($scope,$routeParams,Urlmaker){$scope.scenario={name:$routeParams.scenarioName,project:$routeParams.projectName},$scope.editScenario=function(project,scenario){Urlmaker.makeUrl("scenarioEdit",project,scenario)}}]),angular.module("ThreeSixtyOneView.directives").directive("msDropdown",["$document","$timeout","$rootScope","$filter","CONFIG","DropdownService","SortAndFilterService","ViewService",function($document,$timeout,$rootScope,$filter,CONFIG,DropdownService,SortAndFilterService,ViewService){return{restrict:"AE",templateUrl:"views/directives/msDropdown.tpl.html",replace:!0,scope:{selectedSortIndex:"@",isActive:"@",id:"@msid",reverse:"@",remove:"@"},controller:["$scope","$element","$attrs",function($scope,$element){var dropdown=$($element).find(".ms-select-list"),currentView=ViewService.getCurrentView(),focusInput=function(){var inputField=$element.find("input");inputField&&$timeout(function(){inputField.focus()})},close=function(){dropdown.addClass("hide"),$document.off("click",close)},setOrderBy=function(item){$scope.selectedFilter="",DropdownService.setActive($scope.id),SortAndFilterService.setFilter("reset","",!1),SortAndFilterService.setFilter("orderBy",item.filter,!0),SortAndFilterService.setSorter($scope.id,item.label)},setFilterBy=function(item,who){var filter={};filter[item.filter]=$scope[who],isActive()&&item?(SortAndFilterService.setFilter("reset","",!1),SortAndFilterService.setFilter("filterBy",filter,!0)):SortAndFilterService.setFilter("reset","",!0)},isActive=function(){return $scope.id===DropdownService.getActive()},dontPassEvent=function(evt){evt&&(evt.preventDefault(),evt.stopPropagation())};$document.on("keypress",function(event){if(13===event.keyCode&&$scope.isActive&&!$scope.enabledOn($scope.selectedFilter)){var menu=DropdownService.getActive(),submitButton=$("#"+menu+" .submit-button");$timeout(function(){angular.element(submitButton).triggerHandler("click")})}}),$rootScope.$on("SortAndFilterService:resetFilterBy",function(){$scope.selectedFilter=null}),$scope.dontPassEvent=dontPassEvent,$scope.DropdownService=DropdownService,$scope.filterBy=!1,$scope.selectedFilter=null,$scope.me=CONFIG.user.name,$scope.name="",$scope.reverse=$scope.reverse.bool(),$scope.items=CONFIG.view[currentView].sortMenu.displayColumns,$scope.selectedItem=CONFIG.view[currentView].sortMenu.displayColumns[$scope.selectedSortIndex],SortAndFilterService.setSorter($scope.id,$scope.selectedItem.label),$scope.isActive&&(DropdownService.setActive($scope.id),SortAndFilterService.setFilter("orderBy",$scope.selectedItem.filter,!1)),$scope.enabledOn=function(which){return which&&which.label===$scope.selectedItem.enabledOn?!1:!0},$scope.submit=function(name){!$scope.selectedFilter||$scope.selectedFilter.label!==$scope.selectedItem.enabledOn||null!==name&&""!==name?($scope.name=name,close(),setFilterBy($scope.selectedFilter,"name")):(window.alert("Please enter a name to filter"),focusInput())},$scope.toggle=function(){dropdown.hasClass("hide")?(dropdown.removeClass("hide"),$timeout(function(){$document.on("click",close)})):(dropdown.addClass("hide"),$document.off("click",close))},$scope.selectSort=function(item){$scope.selectedItem=item,SortAndFilterService.setFilter("reset","",!1),$scope.filterBy=SortAndFilterService.hasFilterBy(),setOrderBy(item)},$scope.select=function(item){"boolean"!=typeof $scope.reverse&&($scope.reverse=$scope.reverse.bool()),isActive()?($scope.reverse=!$scope.reverse,SortAndFilterService.setFilter("reverse",$scope.reverse,!0)):($scope.selectedItem=item,SortAndFilterService.setFilter("reverse",$scope.reverse,!1),setOrderBy(item))},$scope.selectFilter=function(which){$scope.enabledOn(which)||$document.off("click",close),$scope.enabledOn($scope.selectedFilter)||$document.on("click",close),$scope.selectedFilter=$scope.selectedFilter===which?"":which,which.label===$scope.selectedItem.enabledOn&&focusInput(),setFilterBy($scope.selectedFilter,$scope.selectedFilter.who),$scope.filterBy=SortAndFilterService.hasFilterBy()}}]}}]).directive("msLinkGroup",["$timeout",function($timeout){return{restrict:"A",controller:function($scope,$element,$attrs){$timeout(function(){$scope.selectedItem=$attrs.firstselected||"none"}),$scope.radio=$attrs.radio||!1,$scope.enabled=!0,this.toggleSelected=function(event){var item=event.data.label;$scope.$apply(function(){$scope.enabled&&(item!==$scope.selectedItem?$scope.selectedItem=item:$scope.radio||($scope.selectedItem="none"))})}}}}]).directive("msLink",[function(){return{restrict:"A",require:"^msLinkGroup",link:function(scope,element,attrs,ctrl){element.on("click",{label:attrs.msLink},ctrl.toggleSelected)}}}]).directive("sortingOptions",["SortAndFilterService",function(SortAndFilterService){return{restrict:"AE",replace:!0,scope:!0,require:"^sorter",link:function($scope,$element,$attrs,ctrl){$scope.label=$attrs.label,$scope.display=$attrs.display,$scope.id=$attrs.msid,$scope.reverse=!1,$scope.SortAndFilterService=SortAndFilterService,$scope.sort=function(evt,which){evt&&(evt.stopPropagation(),evt.preventDefault()),which===$scope.SortAndFilterService.getOrderBy()?$scope.reverse=!$scope.reverse:ctrl.setOrderBy(which,$scope.id,!1),ctrl.setReverse($scope.reverse,!0)}},templateUrl:"views/directives/sorting_options.html"}}]).directive("sorter",["SortAndFilterService","DropdownService",function(SortAndFilterService,DropdownService){return{restrict:"AE",controller:function($scope,$element,$attrs){$scope.reverse=!1,$scope.orderBy=$attrs.orderby,this.setOrderBy=function(which,id,filter){SortAndFilterService.setFilter("orderBy",which,filter),DropdownService.setActive(id)},this.setReverse=function(reverse,filter){SortAndFilterService.setFilter("reverse",reverse,filter)}}}}]).directive("triStateCheckbox",[function(){return{replace:!0,restrict:"E",scope:{checkboxes:"="},template:'<input type="checkbox" ng-model="master" ng-change="masterChange()">',controller:function($scope,$element,$attrs,filterFilter,SortAndFilterService){$scope.items=[];var self=this;this.getSelectedCheckBoxes=function(){return $scope.items},$scope.$on("SortAndFilterService:filter",function(){$scope.masterChange()}),$scope.masterChange=function(){$scope.items=[],$scope.master?angular.forEach(filterFilter($scope.checkboxes,SortAndFilterService.getActiveFilters()),function(cb){cb.isSelected=!0,$scope.items.push(cb)}):angular.forEach($scope.checkboxes,function(cb){cb.isSelected=!1})},this.reset=function(){angular.forEach($scope.checkboxes,function(cb){cb.isSelected=!1})},$scope.$watch("checkboxes",function(){$scope.items=[];var allSet=!0,allClear=!0;self.items=[],angular.forEach($scope.checkboxes,function(cb){cb.isSelected?($scope.items.push(cb),allClear=!1):allSet=!1}),allSet?($scope.master=!0,$element.prop("indeterminate",!1)):allClear?($scope.master=!1,$element.prop("indeterminate",!1)):($scope.master=!1,$element.prop("indeterminate",!0))},!0)}}}]).directive("deleteServiceForCheckbox",["FileDeleteService",function(FileDeleteService){return{restrict:"A",require:"triStateCheckbox",link:function(scope,element,attrs,ctrl){scope.$watch(ctrl.getSelectedCheckBoxes,function(){FileDeleteService.setFilesToDelete(ctrl.getSelectedCheckBoxes())}),scope.$watch(FileDeleteService.getReset,function(){ctrl.reset(),FileDeleteService.resetReset()})}}}]).directive("sortableColumns",[function(){return{templateUrl:"views/directives/sortable_columns.tpl.html",restrict:"AE",replace:!0,scope:{item:"=",displayBy:"="}}}]).directive("focus",["$timeout",function($timeout){return{restrict:"A",link:function(scope,element){$timeout(function(){element[0].focus()},300)}}}]).directive("search",["$timeout","SortAndFilterService",function($timeout){return{template:'<span><i class="fa fa-search" ng-click="toggleSearchField()"></i>&nbsp;<span ng-show="searchVisible" class="search-holder"><input type="text" class="search-input" ng-model="SortAndFilterService.searchText" ng-change="SortAndFilterService.filter()"/>&nbsp<a ng-click="toggleSearchField()" class="close-button"><i class="fa fa-times"></i></a></span></span>',restrict:"AE",replace:!0,link:function($scope,$element){var inputField=$element.find("input");$scope.searchVisible=!1,$scope.toggleSearchField=function(){$scope.searchVisible?$scope.SortAndFilterService.resetSearchText():$timeout(function(){inputField[0].focus()},300),$scope.searchVisible=!$scope.searchVisible}}}}]).directive("inlineRename",["ViewService",function(ViewService){return{replace:!0,template:'<div class="inlineRename"><span ng-transclude></span><h4 class="title" ng-hide="isActive">{{item.title}}</h4>&nbsp;<a class="edit" ng-click="action()"><icon ng-hide="isActive" type="pencil" class="pencil clearfix"></icon></a><h4 ng-show="isActive"><input ng-model="item.title" type="text"></input>&nbsp;<a ng-click="submit()"><icon type="check"></icon></a>&nbsp;<a ng-click="cancel()"><icon type="times"></icon></a></h4></div>',restrict:"E",transclude:!0,scope:{item:"="},link:function($scope){var tempTitle,service=ViewService.getModel();$scope.isActive=!1,$scope.action=function(){$scope.isActive?$scope.isActive=!1:(tempTitle=$scope.item.title,$scope.isActive=!0)},$scope.submit=function(){service.$set($scope.item),$scope.isActive=!1},$scope.cancel=function(){$scope.item.title=tempTitle,$scope.isActive=!1}}}}]).directive("icon",[function(){return{restrict:"E",scope:{icon:"@type",cname:"@"},replace:!0,template:'<i class="fa fa-{{icon}} {{cname}}"></i>'}}]).directive("displayActions",[function(){return{restrict:"AE",replace:!0,templateUrl:"views/directives/display_actions.tpl.html",link:function(scope,element,attrs){function toggleActions(){_.each(show,function(e){scope.view[e]=!0})}scope.view={},scope.view.create=!1,scope.view.filter=!1,scope.view.search=!1,scope.view.tray=!1;var show=scope.$eval(attrs.show);toggleActions(show),scope.trash=function(){scope.DiaglogService.trash()},scope.create=function(type){scope.DiaglogService.create(type)}}}}]).directive("contextualMenu",["$rootScope","$route","CONFIG","ActiveSelection","DiaglogService","FavoritesService","ViewService","InfoTrayService",function($rootScope,$route,CONFIG,ActiveSelection,DiaglogService,FavoritesService,ViewService,InfoTrayService){return{restrict:"AE",templateUrl:"views/directives/contextual_menu.tpl.html",scope:{item:"=",cname:"@"},replace:!0,link:function(scope){function setView(which){if(which){var set=!1;for(var prop in menuViews)if(which[prop]&&which[prop]===menuViews[prop].type){setValues(actions,menuViews[prop].value),set=!0;break}set||setValues(actions,menuViews.otherwise)}}function setValues(actions,values){_.each(actions,function(e,i){scope[e.name]={},scope[e.name].show=!!parseInt(values[i]),scope[e.name].label=e.label||e.name,scope[e.name].config=e.config})}var actions=CONFIG.view[ViewService.getCurrentView()].contextualMenu.actions,menuViews=CONFIG.view[ViewService.getCurrentView()].contextualMenu.views;scope.DiaglogService=DiaglogService,scope.FavoritesService=FavoritesService,scope.InfoTrayService=InfoTrayService,scope.ActiveSelection=ActiveSelection,scope.service=ViewService.getModel(),scope.actions=actions,$rootScope.$on("ViewService:modelChange",function(event,data){scope.service=data}),scope.alert=function(msg){window.alert(msg)},setView(scope.item),scope.copyFn=function(item){console.info(scope.copy),DiaglogService.name(item,scope.copy,scope.service)}}}}]).directive("elastic",["$timeout","ActiveSelection",function($timeout){return{restrict:"A",link:function(scope,element){var resize=function(){return element[0].style.height+"px"+element[0].scrollHeight+"px"};element.on("blur keyup change",resize),$timeout(resize,0),scope.$on("ActiveSelection:activeItemChange",function(){$timeout(resize,0)})}}}]),angular.module("ThreeSixtyOneView.services").service("FileDeleteService",["$rootScope",function($rootScope){var service,filesToDelete=[],reset=!1;$rootScope.$on("ViewService:modelChange",function(event,data){service=data}),this.setFilesToDelete=function(files){filesToDelete=files,$rootScope.$broadcast("FileDeleteService:change")},this.getFilesToDelete=function(){return filesToDelete},this.remove=function(){this.deleteFiles(_.pluck(filesToDelete,"id")),this.reset()},this.deleteFiles=function(files){service.$delete(files)},this.getFileCount=function(){return filesToDelete.length},this.reset=function(){reset=!0,filesToDelete=[],$rootScope.$broadcast("FileDeleteService:change")},this.resetReset=function(){reset=!1},this.getReset=function(){return reset}}]),angular.module("ThreeSixtyOneView.services").service("SortAndFilterService",["$filter","$rootScope","filterFilter",function($filter,$rootScope,filterFilter){var sorters={},filterBy={},orderBy="",reverse=!1,activeFilters={},selected={label:"default"},searchText="",filters=[],data={},display={},set={activeFilter:function(toWhat){setActiveFilter(toWhat)},reverse:function(toWhat){this.setReverse(toWhat)},filterBy:function(toWhat){this.setFilterBy(toWhat)},orderBy:function(toWhat){this.setOrderBy(toWhat)},reset:function(){resetFilterBy()},filterPipeline:function(toWhat){resetActiveFilters(),setSelected(toWhat),addToPipline(toWhat)}},getFilter=function(filter){return function(data){return $filter(filter)(data)}},addToPipline=function(which){var filter=getFilter(which.filter);filters.push(filter)},clearPipeline=function(){filters=[]},filterPipline=function(data){return _.reduce(filters,function(memo,num){return num(memo)},data)},resetFilterBy=function(){filterBy={}},setActiveFilters=function(value){activeFilters=value},resetActiveFilters=function(){activeFilters={}},setSelected=function(value){selected=value},setActiveFilter=function(item){clearPipeline(),item?(setSelected(item),setActiveFilters(item.filter)):resetActiveFilters(),resetFilterBy(),$rootScope.$broadcast("SortAndFilterService:resetFilterBy")},self=this;display.data={},this.setSorter=function(id,sorter){sorters[id]=sorter},this.getSorter=function(id){return sorters[id]},this.setOrderBy=function(which){orderBy=which},this.getOrderBy=function(){return orderBy},this.isActive=function(which){return this.getOrderBy()===which},this.setReverse=function(which){reverse=which},this.getReverse=function(){return reverse},this.setFilterBy=function(obj){filterBy=obj},this.getFilterBy=function(){return filterBy},this.hasFilterBy=function(){return _.isEmpty(filterBy)?!1:!0},this.getActiveFilters=function(){return activeFilters},this.getSearchText=function(){return this.searchText},this.setSearchText=function(value){this.searchText=searchText=value},this.resetSearchText=function(){this.searchText=searchText="",this.filter()},this.getSelected=function(){return selected},this.getSelectedLabel=function(){return selected.label},this.getCount=function(){try{return display.data.length}catch(e){console.info("No data")}},this.getData=function(){return display.data},this.searchText=searchText,this.setFilter=function(which,toWhat,filter){set[which].call(this,toWhat),filter&&this.filter()},this.init=function(config){data=config.data,display=angular.copy(data),this.setFilter("orderBy",config.orderBy,!1),this.setFilter("reverse",config.reverse,!1),this.setFilter("activeFilter",config.filter,!0),$rootScope.$on("ProjectsModel:dataChange",function(event,response){$rootScope.$apply(function(){data.data=response.data,self.filter()})})},this.filter=function(){var activeFilters=this.getActiveFilters(),filterBy=this.getFilterBy(),searchText=this.getSearchText(),temp=data.data;temp=filterFilter(temp,activeFilters),temp=filterFilter(temp,filterBy),temp=filterFilter(temp,{title:searchText}),temp=$filter("orderBy")(temp,this.getOrderBy(),this.getReverse()),temp=filterPipline(temp),display.data=temp,$rootScope.$broadcast("SortAndFilterService:filter")}}]),function(){"use strict";function Files(futureData){this.$unwrap(futureData)}Files.$factory=["$timeout","Resource","SERVER","$rootScope",function($timeout,Resource,SERVER,$rootScope){return _.extend(Files,{$$resource:new Resource(SERVER.local+"/api/items"),$timeout:$timeout,$rootScope:$rootScope}),Files}],angular.module("ThreeSixtyOneView.services").factory("FilesModel",Files.$factory),Files.$find=function(uid){Files.data=new Files(this.$$resource.get(uid))},Files.$get=function(){return Files.data},Files.$clone=function(id){Files.$$resource.clone(id).then(function(response){Files.$timeout(function(){Files.data.data.push(response)})})},Files.$delete=function(ids){Files.$$resource.remove(ids).then(function(response){Files.$timeout(function(){Files.data.data=response.data,Files.data.counts=response.counts})})},Files.$edit=function(item){var index=Files.getItemIndex(item);console.info(index),Files.$$resource.set(item).then(function(response){Files.$timeout(function(){Files.data.data[index]=response.data,Files.$rootScope.$broadcast("FilesModel:edit",{data:response.data})})})},Files.$set=function(item){Files.$edit(item)},Files.$create=function(config){Files.$$resource.create(config).then(function(response){Files.$timeout(function(){console.info(response),Files.data.data=response.data,Files.data.counts=response.counts})})},Files.update=function(config){var item=Files.getItemById(config.id);item&&(item[config.prop]=config.value,Files.$set(item))},Files.getItemById=function(id){for(var item=!1,items=Files.data.data,x=0,limit=items.length;limit>x;x++)if(items[x].id===id)return items[x];return item},Files.getItemIndex=function(item){for(var x=0,limit=Files.data.data.length;limit>x;x++)if(item.id===Files.data.data[x].id)return x},Files.prototype.$unwrap=function(futureData){var self=this;this.$futureData=futureData,this.$futureData.then(function(data){Files.$timeout(function(){_.extend(self,data)})})}}(),angular.module("ThreeSixtyOneView.services").factory("Resource",["$http","$q",function($http,$q){function Resource(http,q,path){this._http=http,this._path=path,this._q=q;var getPath=function(uid){return uid?this._path+"/"+uid:this._path};this.get=function(uid,con){var deferred=this._q.defer(),config=con||{};return this._http.get(getPath.call(this,uid),config).success(deferred.resolve).error(deferred.reject),deferred.promise},this.post=function(data,con){var path,deferred=this._q.defer(),config=con||{};return"undefined"==typeof data?(deferred.reject("I need an item template"),deferred.promise):(path=this._path,this._http.post(path,data,config).success(deferred.resolve).error(deferred.reject),deferred.promise)},this.create=this.post,this.put=function(params,con){var deferred=this._q.defer(),config=con||{};return"undefined"==typeof params?(deferred.reject("I need an params with an id"),deferred.promise):(this._http.put(this._path,params,config).success(deferred.resolve).error(deferred.reject),deferred.promise)},this.delete=function(item,con){var deferred=this._q.defer(),config=con||{};return"undefined"==typeof item?(deferred.reject("I need an item with an id"),deferred.promise):(this._http.delete(this._path,item,config).success(deferred.resolve).error(deferred.reject),deferred.promise)
}}return function(path){return new Resource($http,$q,path)}}]),angular.module("ThreeSixtyOneView.filters").filter("isFavorite",["FavoritesService",function(FavoritesService){return function(input){var results=[];return FavoritesService.getFavorites().length>0&&_.each(input,function(e){FavoritesService.isFavorite(e.id)&&results.push(e)}),results}}]).filter("camelCase",[function(){return function(input){return"string"==typeof input?input.toLowerCase().replace(/ (.)/g,function(match,group1){return group1.toUpperCase()}):input}}]).filter("dateRange",[function(){var dayInMillisec=864e5;return function(input,db,p){var results=[],prop=p||"lastModified",daysBack=parseInt(db,10),now=Date.now(),threshold=new Date(now-dayInMillisec*daysBack);if(0===daysBack)return input;for(var i=0,limit=input.length;limit>i;i++)new Date(input[i][prop])>threshold&&results.push(input[i]);return results}}]).filter("capitalize",[function(){return function(input){return input.substring(0,1).toUpperCase()+input.substring(1)}}]).filter("unCamelCase",[function(){return function(input){return input.replace(/([a-z\d])([A-Z\d])/g,"$1 $2")}}]).filter("normalize",[function(){return function(input){return input.replace(/\s/g,"").toLowerCase()}}]).filter("timeago",[function(){return function(time,local,raw){if(!time)return"never";if(local||(local=Date.now()),angular.isDate(time)?time=time.getTime():"string"==typeof time&&(time=new Date(time).getTime()),angular.isDate(local)?local=local.getTime():"string"==typeof local&&(local=new Date(local).getTime()),"number"==typeof time&&"number"==typeof local){var offset=Math.abs((local-time)/1e3),span=[],MINUTE=60,HOUR=3600,DAY=86400,WEEK=604800,YEAR=31556926,DECADE=315569260;return span=MINUTE>=offset?["",raw?"now":"less than a minute"]:60*MINUTE>offset?[Math.round(Math.abs(offset/MINUTE)),"min"]:24*HOUR>offset?[Math.round(Math.abs(offset/HOUR)),"hr"]:7*DAY>offset?[Math.round(Math.abs(offset/DAY)),"day"]:52*WEEK>offset?[Math.round(Math.abs(offset/WEEK)),"week"]:10*YEAR>offset?[Math.round(Math.abs(offset/YEAR)),"year"]:100*DECADE>offset?[Math.round(Math.abs(offset/DECADE)),"decade"]:["","a long time"],span[1]+=0===span[0]||span[0]>1?"s":"",span=span.join(" "),raw===!0?span:local>=time?span+" ago":"in "+span}}}]),angular.module("ThreeSixtyOneView.services").service("ActiveSelection",["$rootScope",function($rootScope){var activeItem="",self=this;this.isActiveItem=function(item){return activeItem===item},this.setActiveItem=function(item){activeItem=this.isActiveItem(item)?"":item,$rootScope.$broadcast("ActiveSelection:activeItemChange",{data:activeItem})},this.getActiveItem=function(){return activeItem},this.activeItem=function(){return 0===activeItem.length?!1:!0},this.clearActiveItem=function(){activeItem=""},$rootScope.$on("FilesModel:edit",function(event,response){self.setActiveItem(response.data)})}]),angular.module("ThreeSixtyOneView.services").factory("DropdownService",[function(){var active;return{getActive:function(){return active},setActive:function(which){active=which}}}]),angular.module("ThreeSixtyOneView.services").service("InfoTrayService",["$rootScope","ActiveSelection",function($rootScope,ActiveSelection){var showInfoTray=!1,self=this;this.toggleInfoTray=function(){showInfoTray=ActiveSelection.activeItem()?!0:!1},this.closeInfoTray=function(){showInfoTray=!1,ActiveSelection.clearActiveItem()},this.getShowInfoTray=function(){return showInfoTray},$rootScope.$on("SortAndFilterService:filter",self.closeInfoTray)}]),angular.module("ThreeSixtyOneView.services").service("DiaglogService",["InfoTrayService","FileDeleteService","dialogs",function(InfoTrayService,FileDeleteService,dialogs){this.trash=function(item){item&&FileDeleteService.setFilesToDelete([item]),dialogs.create("views/modal/delete.html","DeleteCtrl",InfoTrayService.closeInfoTray)},this.copy=function(item,config,service){var header=config.header||"Copy",text=config.text||"Do you want to copy ",dlg=dialogs.confirm(header,text+item.title+"?");dlg.result.then(function(btn){console.info(btn),service.$clone(item.id)},function(btn){console.info(btn)})},this.name=function(item,data,service){dialogs.create("views/modal/name.html","NameCtrl",{item:item,service:service,config:data.config})},this.rename=function(item,service){dialogs.create("views/modal/rename.html","RenameCtrl",{item:item,service:service})},this.create=function(type){var createTypes={element:{controller:"CreateCtrl",template:"views/modal/create_scenario.tpl.html"},project:{controller:"ProjectCreateCtrl",template:"views/modal/create_project.tpl.html"}};dialogs.create(createTypes[type].template,createTypes[type].controller,{},{size:"sm"})}}]),angular.module("ThreeSixtyOneView.services").service("ProjectsModel",["$timeout","$rootScope","Resource","CONFIG","SERVER","dialogs",function($timeout,$rootScope,Resource,CONFIG,SERVER,dialogs){var resource=new Resource(SERVER.remote+CONFIG.application.api.projects),translator=CONFIG.application.models.ProjectsModel.translator,config={transformResponse:function(data){return{data:translate(data,translator)}}},translate=function(response,translator){var results,data,translateObj=function(data){var result={},t;return _.each(translator,function(k,v,o){t=data[k],"undefined"!=typeof t?result[v]=t:_.isObject(k)&&(result[v]=eval("data"+k.selector))}),result};try{data=JSON.parse(response)}catch(e){return console.error("no data received or data will not parse to json"),void dialogs.error("No data received!!!","Either the server is down or the response is not JSON.")}if(_.isArray(data))results=[],_.each(data,function(e){results.push(translateObj(e))});else if(_.isObject)return translateObj(data);return results},unwrap=function(futureData){var self=this;this.$futureData=futureData,this.$futureData.then(function(data){$timeout(function(){_.extend(self,data)})})},put=function(data){resource.put(data,config).then(function(response){var item=_.indexOf(self.data,_.findWhere(self.data,{id:response.data.id}));self.data.splice(item,1,response.data),$timeout(function(){$rootScope.$broadcast("ProjectsModel:dataChange",{data:self.data})})})},self=this;this.find=function(uid){unwrap.call(this,resource.get(uid,config))},this.get=function(){return this.$futureData},this.create=function(data){resource.create(data,config).then(function(response){$timeout(function(){self.data.push(response.data),$rootScope.$broadcast("ProjectsModel:dataChange",{data:self.data})})})},this.rename=function(data){var obj=_.pick(data,"name","description");obj.uuid=data.id,put.call(this,obj)}}]),angular.module("ThreeSixtyOneView.services").service("FavoritesModel",["$timeout","$rootScope","Resource","CONFIG","SERVER",function($timeout,$rootScope,Resource,CONFIG,SERVER){var resource=new Resource(SERVER.remote+CONFIG.application.api.favorites),config={},unwrap=function(futureData){var self=this;this.$futureData=futureData,this.$futureData.then(function(data){$timeout(function(){_.extend(self,data)})})};this.find=function(id){unwrap.call(this,resource.get(id,config))},this.get=function(){return this.$futureData},this.setAsFavorite=function(id){resource.post({uuid:id},config).then(function(response){console.info(response)})},this.unFavorite=function(id){var params={params:{uuid:id}};resource.delete(params,config).then(function(response){console.info(response)})}}]),angular.module("ThreeSixtyOneView.services").service("FavoritesService",["FavoritesModel",function(FavoritesModel){var favorites=[],removeFavorite=function(itemID){_.indexOf(favorites,itemID)>-1&&(favorites.splice(_.indexOf(favorites,itemID),1),FavoritesModel.unFavorite(itemID))};this.setFavorites=function(f){favorites=f},this.addFavorite=function(itemID){favorites.push(itemID),FavoritesModel.setAsFavorite(itemID)},this.isFavorite=function(itemID){var index=_.indexOf(favorites,itemID);return index>-1?!0:!1},this.toggleFavorite=function(item,evt){var itemID=item.id;this.isFavorite(itemID)?removeFavorite(itemID):this.addFavorite(itemID),evt&&evt.stopPropagation()},this.getFavorites=function(){return favorites}}]),angular.module("ThreeSixtyOneView.services").service("ViewService",["$rootScope","$route",function($rootScope,$route){var model,currentView,self=this;this.setModel=function(which){model=which,$rootScope.$broadcast("ViewService:modelChange",which)},this.getModel=function(){return model},this.setCurrentView=function(view){currentView=view},this.getCurrentView=function(){return currentView},$rootScope.$on("$routeChangeSuccess",function(){self.setCurrentView($route.current.$$route.viewName)})}]),angular.module("ThreeSixtyOneView").controller("DeleteCtrl",["$scope","data","$modalInstance","FileDeleteService",function($scope,data,$modalInstance,FileDeleteService){var callback=data;$scope.FileDeleteService=FileDeleteService,$scope.cancel=function(){console.info("cancel"),FileDeleteService.reset(),$modalInstance.dismiss("canceled")},$scope.delete=function(){console.info("delete"),FileDeleteService.remove(),callback(),$modalInstance.close("delete")}}]).controller("CreateCtrl",["$scope","$rootScope","$modalInstance",function($scope,$rootScope,$modalInstance){$scope.create=function(item){$modalInstance.dismiss("create"),$rootScope.$broadcast("CreateCtrl:create",item)},$scope.close=function(){console.info("cancel"),$modalInstance.dismiss("canceled")}}]).controller("RenameCtrl",["$scope","$modalInstance","data",function($scope,$modalInstance,data){var service=data.service;$scope.data=data.item,$scope.name=$scope.data.title,$scope.rename=function(name){$scope.data.name=name,service.rename($scope.data),$modalInstance.dismiss("create")},$scope.close=function(){console.info("cancel"),$modalInstance.dismiss("canceled")}}]).controller("NameCtrl",["$scope","$modalInstance","data","ViewService",function($scope,$modalInstance,data,ViewService){$scope.data=data.item,$scope.config=data.config,$scope.name=$scope.data.title+" - copy",$scope.submit=function(name){var service=ViewService.getModel();service.$clone(data.item.id,name),$modalInstance.dismiss("create")},$scope.close=function(){$modalInstance.dismiss("canceled")}}]).controller("ProjectCreateCtrl",["$scope","$rootScope","$modalInstance","ProjectsModel","CONFIG",function($scope,$rootScope,$modalInstance,ProjectsModel,CONFIG){$scope.close=function(){$modalInstance.dismiss("canceled")},$scope.create=function(name){var newProject=CONFIG.view.ProjectManager.newProject;newProject.name=name,ProjectsModel.create(newProject),$rootScope.$broadcast("ProjectCreateCtrl:create",newProject.name),$modalInstance.dismiss("create")}}]),angular.module("ThreeSixtyOneView.config").constant("SERVER",{local:"http://127.0.0.1:3001",remote:"http://ec2-54-205-7-240.compute-1.amazonaws.com:8080"}),angular.module("ThreeSixtyOneView.config").constant("CONFIG",{application:{api:{projects:"/rubix/v1/project",favorites:"/rubix/v1/favorite/project/"},models:{ProjectsModel:{translator:{isMaster:"isMaster",id:"uuid",title:"name",description:"description",createdBy:{selector:"['auditInfo']['createdBy']['name']"},createdOn:{selector:"['auditInfo']['createdOn']"},modifiedBy:{selector:"['auditInfo']['lastUpdatedBy']['name']"},modifiedOn:{selector:"['auditInfo']['lastUpdatedOn']"}}}}},session:{},view:{Dashboard:{model:"ProjectsModel",orderBy:"modifiedOn",filter:"CONFIG.view.Dashboard.filterMenu.items[0]",reverse:!0,topInclude:"views/includes/dashboard_top.tpl.html",status:!0,where:"gotoScenarioEdit",displayActionsCreate:"element",filterMenu:{firstSelected:0,title:"Scenarios",icon:"database",items:[{label:"all scenarios",filterType:"activeFilter",filter:{}}]},sortMenu:{displayColumns:[{label:"Last Modified",filter:"modifiedOn"},{label:"Modified By",filter:"modifiedBy",filters:[{label:"Modified by me",filter:"modifiedBy",who:"me"},{label:"Modified by:",filter:"modifiedBy",who:"name"}],template:"views/directives/name.tpl.html",enabledOn:"Modified by:"},{label:"Creator",filter:"createdBy",filters:[{label:"Created by me",filter:"createdBy",who:"me"},{label:"Created by:",filter:"createdBy",who:"name"}],template:"views/directives/name.tpl.html",enabledOn:"Created by:"}]},contextualMenu:{actions:[{name:"base",label:"use as base for a new scenario"},{name:"copy",label:"copy as a new scenario",config:{title:"Copy Scenario",description:"",submit:{label:"copy as new scenario"},cancel:{label:"cancel"}}},{name:"set",label:"set as current plan"},{name:"rename"},{name:"archive"},{name:"details"}],views:{defaults:{type:"master",value:"010001"},otherwise:"111111"}}},CentralManager:{model:"FilesModel",orderBy:"lastModified",filter:"CONFIG.view.CentralManager.filterMenu.items[0]",reverse:!0,favorites:!1,filterMenu:{firstSelected:0,title:"Scenario Elements",icon:"cog",items:[{label:"defaults",filterType:"activeFilter",filter:{defaults:!0}},{label:"Economy",filterType:"activeFilter",filter:{type:"Economy"}},{label:"Competition",filterType:"activeFilter",filter:{type:"Competition"}},{label:"Labor Cost",filterType:"activeFilter",filter:{type:"Labor Cost"}},{label:"Pricing",filterType:"activeFilter",filter:{type:"Pricing"}},{label:"Cost Assumptions",filterType:"activeFilter",filter:{type:"Cost Assumptions"}}]},contextualMenu:{actions:[{name:"copy"},{name:"sharing"},{name:"rename"},{name:"archive"},{name:"add"},{name:"details"}],views:{defaults:{type:"master",value:"100001"},access:{type:"view only",value:"100001"},otherwise:"101101"}},sortMenu:{displayColumns:[{label:"Last Modified",filter:"lastModified"},{label:"Modified By",filter:"modifiedBy",filters:[{label:"Modified by me",filter:"modifiedBy"},{label:"Modified by:",filter:"modifiedBy"}],template:"views/directives/name.tpl.html",enabledOn:"Modified by:"},{label:"Owner",filter:"owner",filters:[{label:"Owned by me",filter:"owner"},{label:"Owned by:",filter:"owner"}],template:"views/directives/name.tpl.html",enabledOn:"Owned by:"}]}},ProjectManager:{model:"ProjectsModel",orderBy:"modifiedOn",filter:"CONFIG.view.ProjectManager.filterMenu.items[0]",reverse:!0,favorites:!0,status:!1,where:"gotoDashboard",displayActionsCreate:"project",newProject:{name:"new name goes here",description:"this is a test",isMaster:!1},filterMenu:{firstSelected:0,icon:"suitcase",title:"Projects",items:[{label:"All",filterType:"activeFilter",filter:{}},{label:"Favorites",filterType:"filterPipeline",filter:"isFavorite"},{label:"Created by me",filterType:"activeFilter",filter:{createdBy:"me"}},{label:"I can edit",filterType:"activeFilter",filter:{access:"Everyone can edit"}}]},contextualMenu:{actions:[{name:"copy",config:{title:"Copy Project",description:"xxxxxxxxxxxxx",submit:{label:"copy"},cancel:{label:"cancel"}}},{name:"favorites",label:"favorite"},{name:"sharing"},{name:"rename"},{name:"archive"},{name:"add"},{name:"details"}],views:{isMaster:{type:!0,value:"0000001"},otherwise:"1101101"}},sortMenu:{displayColumns:[{label:"Last Modified",filter:"modifiedOn"},{label:"Modified By",filter:"modifiedBy",filters:[{label:"Modified by me",filter:"modifiedBy",who:"me"},{label:"Modified by:",filter:"modifiedBy",who:"name"}],template:"views/directives/name.tpl.html",enabledOn:"Modified by:"},{label:"Creator",filter:"createdBy",filters:[{label:"Created by me",filter:"createdBy",who:"me"},{label:"Created by:",filter:"createdBy",who:"name"}],template:"views/directives/name.tpl.html",enabledOn:"Created by:"}]}}},user:{name:"me",role:"default user",favorites:[]}}),angular.module("ThreeSixtyOneView.services").service("Urlmaker",["$location",function($location){this.makeUrl=function(type){var args=Array.prototype.slice.call(arguments,1);switch(type){case"dashboard":makeDashboardUrl.apply(this,args);break;case"projects":makeProjectUrl.apply(this,args);break;case"scenarioEdit":makeScenarioEditURL.apply(this,args);break;case"scenarioCreate":makeScenarioCreateUrl.apply(this,args)}};var makeDashboardUrl=function(name){var url="/dashboard/"+name;$location.path(url)},makeProjectUrl=function(){var url="/projects";$location.path(url)},makeScenarioEditURL=function(project,scenario){var url="/scenarioEdit/"+project+"/"+scenario;$location.path(url)},makeScenarioCreateUrl=function(project,scenario){var url="/scenarioCreate/"+project+"/"+scenario;$location.path(url)}}]),angular.module("ThreeSixtyOneView.directives").directive("inputEdit",["$rootScope",function($rootScope){return{template:'<span><span ng-click="activate(this)"><span ng-hide="editMode">{{value}}</span><span ng-show="editMode"><input class="editable" type="text" ng-model="value" ng-change="change()"/></span></span><span ng-show="editMode">&nbsp;<a ng-click="submit()"><icon type="check"></icon></a>&nbsp;<a ng-click="cancel()"><icon type="times"></icon></a></span></span>',restrict:"EA",scope:{value:"@"},replace:!0,link:function(scope){var currentText;scope.editMode=!1,scope.activate=function(which){scope.editMode||(scope.editMode=!scope.editMode,currentText=scope.value),$rootScope.$broadcast("inputEdit:opened",which)},scope.cancel=function(){$rootScope.$broadcast("inputEdit:save","revert"),scope.value=currentText,scope.editMode=!1},scope.change=function(){$rootScope.$broadcast("inputEdit:change","editing")},scope.submit=function(){$rootScope.$broadcast("inputEdit:save","saving"),scope.editMode=!1},scope.$on("inputEdit:opened",function(evnt,data){data!==scope&&(scope.editMode=!1)})}}}]).directive("savedState",["$timeout","$rootScope",function($timeout){return{template:"<span>{{state}}</span>",replace:!0,restrict:"AE",link:function(scope){var msg={};msg.done="",msg.editing="you have unsaved changes",msg.saving="saving changes",msg.revert="reverting - nothing was saved",scope.state=msg.done;var setState=function(which){scope.state=msg[which]},setStateAndRemove=function(which){scope.state=msg[which],$timeout(function(){scope.state=msg.done},3e3)};scope.$on("inputEdit:change",function(evnt,data){setState(data)}),scope.$on("inputEdit:save",function(evnt,data){setStateAndRemove(data)})}}}]),angular.module("ThreeSixtyOneView").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/contextual_menu.tpl.html",'<div class="contextual-menu">\r\n	<div class=\'dropdown-toggle\' data-toggle="dropdown">\r\n		<icon type="ellipsis-v" cname="dropdown-trigger"></icon>\r\n	</div>\r\n	<ul class="dropdown-menu contextual-menu-body" role="menu">\r\n		<li ng-if="base.show" class=\'base\'>\r\n			<a ng-click="alert(\'this behavior has not been defined\')">\r\n				<icon type="download"></icon>\r\n				<!-- Use as a base for a new scenario -->\r\n				{{base.label}}\r\n			</a>\r\n		</li>\r\n\r\n		<li ng-if="copy.show" class=\'copy\'>\r\n			<!-- <a ng-click="DiaglogService.copy(item, {header: \'Copy Project\'}, service)"> -->\r\n			<a ng-click="copyFn(item)">\r\n				<icon type="files-o"></icon>\r\n				<!-- copy -->\r\n				{{copy.label}}\r\n			</a>\r\n		</li>\r\n\r\n		<li ng-if="set.show" class=\'set\'>\r\n			<a ng-click="">\r\n				<icon type="marketshare"></icon>\r\n				<!-- Set as current plan -->\r\n				{{set.label}}\r\n			</a>\r\n		</li>\r\n\r\n		<li ng-if="favorites.show" class=\'favorites no-after\'>\r\n			<a ng-click="FavoritesService.toggleFavorite(item)">\r\n				<span ng-if="!FavoritesService.isFavorite(item.id)">\r\n					<icon type="star"></icon>\r\n					{{favorites.label}}\r\n				</span>\r\n				<span ng-if="FavoritesService.isFavorite(item.id)">\r\n					<icon type="star-o"></icon>\r\n					un-{{favorites.label}}\r\n				</span>\r\n			</a>\r\n		</li>\r\n		<li ng-if="default.show" class=\'default\'>\r\n			<a ng-click="alert(\'this behavior has not been defined\')" ng-class="{disabled: item.defaults}">	\r\n				<img src="images/ms-confirm_gray.png" width="18" height="16">\r\n				<span>&nbsp;{{default.label}}</span>\r\n			</a>\r\n		</li>\r\n		<li ng-if="add.show" class="add">\r\n			<a ng-click="alert(\'this behavior has not been defined\')">\r\n				<icon type="download"></icon>\r\n				{{add.label}}\r\n			</a>\r\n		</li>\r\n		<li ng-if="sharing.show" class=\'sharing"\'>\r\n			<a ng-click="alert(\'this behavior has not been defined\')">\r\n				<icon type="users"></icon>\r\n				{{sharing.label}}\r\n			</a>\r\n		</li>\r\n		<li ng-if="archive.show" class="delete">\r\n			<a ng-click="DiaglogService.trash(item, service)">\r\n				<icon type="trash-o"></icon>\r\n				{{archive.label}}\r\n			</a>\r\n		</li>\r\n		<li ng-if="rename.show" class="rename">\r\n			<a ng-click="DiaglogService.rename(item, service)">\r\n				<icon type="pencil"></icon>\r\n				{{rename.label}}\r\n			</a>\r\n		</li>\r\n		<li ng-if="details.show" class="divider"></li>\r\n		<li ng-if="details.show" class="details">\r\n			<a ng-click="ActiveSelection.setActiveItem(item);InfoTrayService.toggleInfoTray()">\r\n				<icon type="info-circle"></icon>\r\n				{{details.label}}\r\n			</a>\r\n		</li>\r\n	</ul>\r\n</div>'),$templateCache.put("views/directives/display_actions.tpl.html",'<div class="display-actions">\r\n	<h4 class="pull-left title">{{SortAndFilterService.getSelectedLabel()}}&nbsp;<span>({{SortAndFilterService.getCount()}})</span></h4>\r\n	\r\n	<div class="button-holder">\r\n\r\n<!-- 		<span ng-show="FileDeleteService.getFileCount()" ng-click="trash()" class="trash"><icon type="trash-o"></icon>&nbsp;Delete({{FileDeleteService.getFileCount()}})</span> -->\r\n\r\n		<div class="actions">\r\n			<span ng-if="view.create" ng-click="create(CONFIG.displayActionsCreate)"><icon type="plus"></icon></span>\r\n			<span ng-if="view.filter"><icon type="filter"></icon></span>\r\n			<span ng-if="view.search"><search></search></span>\r\n		</div>\r\n		\r\n	</div>\r\n</div>'),$templateCache.put("views/directives/msDropdown.tpl.html",'<div class="ms-dropdown" id="{{id}}"> \r\n	<h6 class="ms-label" ng-class="{active: DropdownService.getActive() === id}"><span ng-show="filterBy"><icon type="filter" cname="filter-icon"></icon></span><span ng-click="select(selectedItem)" class="status select">{{selectedItem.label}}</span>&nbsp<span ng-click="toggle()" class="toggle"><icon type="caret-square-o-down"></icon></span></h6> \r\n	<ul class="ms-select-list dropshadow hide"> \r\n		<li class="ms-item selectSort" ng-repeat="item in items" ng-class="{disabled:item.label === selectedItem.label}" ng-click="selectSort(item)"><span class="glyphicon glyphicon-ok ms-ok"></span>{{item.label}}</li> \r\n		<ul ng-if="selectedItem.filters"> \r\n			<li class="divider"></li> \r\n			<li class="ms-sublabel">FILTER</li> \r\n			<li ng-repeat="filter in selectedItem.filters" class="ms-item selectFilter" ng-click="selectFilter(filter)" ng-class="{selected:selectedFilter === filter}"><span class="glyphicon glyphicon-ok ms-ok"></span>{{filter.label}}</li> \r\n			<li ng-if="selectedItem.template"><ng-include src="selectedItem.template"></ng-include></li> \r\n		</ul> \r\n	</ul> \r\n</div>'),$templateCache.put("views/directives/name.tpl.html",'<li class="ms-holder">\r\n	<input type="text" class="ms-name-input" ng-model="name" placeholder="Enter Name" ng-disabled="enabledOn(selectedFilter)" ng-click="dontPassEvent($event)"/>\r\n</li>\r\n<li class="ms-holder">\r\n	<button class="btn btn-primary ms-apply submit-button" ng-disabled="!name || enabledOn(selectedFilter)" ng-click="submit(name)">apply</button>\r\n</li>\r\n'),$templateCache.put("views/directives/sortable_columns.tpl.html",'<div ng-switch on="displayBy" class="text-holder"> \r\n	<span ng-switch-when="Last Modified">{{item.modifiedOn | timeago }}</span> \r\n	<span ng-switch-when="Modified By">{{item.modifiedBy}}</span> \r\n	<span ng-switch-when="Type">{{item.type}}</span> \r\n	<span ng-switch-when="Creator">{{item.createdBy}}</span> \r\n	<span ng-switch-default>FAIL</span> \r\n</div>'),$templateCache.put("views/directives/sorting_options.html",'<div class="{{label}} heading" ng-class="{\'active\': SortAndFilterService.isActive(label)}">\r\n	<a ng-click="sort($event, label)" ng-bind="display"></a>&nbsp;\r\n</div> ')}]);