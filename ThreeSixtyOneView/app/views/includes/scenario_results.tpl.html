<div class="scenario_results">

    <section class="results-dropdown">
        <div class="dropdown">
            <span>Results compared to </span>
            <span class="dropdown-toggle">
                {{selectedView.title}} <icon type="caret-down"></icon>
            </span>
          <ul class="dropdown-menu" ms-link-group selected-item="{{selectedView.id}}" radio="true">
            <li ng-repeat="view in getComparedViews()" ms-link="{{view.id}}" >
                <a href="" ng-click="setComparedView(view)">{{view.title}}</a>
            </li>
          </ul>
        </div>
    </section>

    <section class="results-view">
        <div>
            <div class="srTitle" ng-class="{srTitleSel: srShow, srGray: !srShow}">
                <div class="srRenameArea">
                    <icon type="eye" ng-class="{srGray: !srShow}"></icon>
                    <div class="srTitleText clickable" ng-click="srShow ? startSaveAs() : (srShow = true)" ng-hide="saveAs">{{viewName}}</div>
                    <div class="srSaveAsBox" ng-show="saveAs">
                        <input type="text" ng-model="saveAsName" ng-keyup="renameAction($event)">
                        <icon type="check" ng-click="finishSaveAs(true)"></icon>
                        <icon type="remove" ng-click="finishSaveAs(false)"></icon>
                    </div>
                </div>
            </div>
            <!-- <div class="srTimestamp">
                <span>Calculated 3:57pm</span>
            </div> -->
            <div class="srToolbar" ng-class="{srTitleSel: !srShow}"></div>
        </div>

        <div ng-class="{srOpened: srShow}" class="srSlider">
            <div class="srControlBar">
                <div class="srSaveMenu" ng-mouseleave="viewSaveMenu = false">
                    <div class="srViewSave">
                        <div class="srSaveHolder">
                            <div class="srSaveButton clickable" ng-click="saveView()"">
                                <icon type="save"></icon> Save View
                            </div>
                            <div class="srSaveDropButton clickable" ng-class="{srSaveDropSelected: viewSaveMenu}" ng-click="viewSaveMenu = !viewSaveMenu">
                                <icon type="caret-down"></icon>
                            </div>
                        </div>
                        <div class="srViewSaveMenu" ng-show="viewSaveMenu">
                            <div class="srViewSaveMenuVisible" ng-click="">
                                <div class="srViewSaveMenuItem clickable" ng-click="startSaveAs(); viewSaveMenu = false;">
                                    <icon type="save"></icon> Save As
                                </div>
                                <div class="srViewSaveMenuItem clickable" ng-click="resetView(); viewSaveMenu = false;">
                                    <icon type="undo"></icon> Revert
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="srViewsList" ng-mouseleave="viewRecentViews = false">
                    <div class="srRecentViewsButton clickable" ng-click="viewRecentViews = !viewRecentViews">
                        <icon type="eye"></icon> Recent Views <icon type="caret-down"></icon>
                    </div>
                    <div class="srRecentViewsMenu" ng-show="viewRecentViews">
                        <div class="srRecentViewsMenuVisible">
                            <div class="clickable" ng-repeat="viewsListItem in viewsList | orderBy:'id'">
                                <icon type="eye"></icon> {{viewsListItem.name}}
                            </div>
                            <hr>
                            <div><icon type="folder-open-o"></icon> All Views</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="srSec">
                <div class="srSecTitle">Spend Filters</div>
                <div class="srFilterValues">
                    <div ng-repeat="cat in dimensions" class="srFilterBox clickable" ng-click="filtersModal(cat)" data-toggle="modal" data-target="#filterModal"  ng-if="addedFilters[cat.label]">
                        <div class="srFilterCat">{{cat.label}} <span class="srFilterSize">({{categorizedValue[$index].selected}}/{{categorizedValue[$index].total}})</span></div>
                        <div class="srFilterVal" ng-show="categorizedValue[$index].selected < categorizedValue[$index].total" data-toggle="tooltip" data-placement="bottom" title="{{categorizedValue[$index].label.join(', ')}}">{{categorizedValue[$index].label.join(', ')}}</div>
                        <div class="srFilterVal" ng-hide="categorizedValue[$index].selected < categorizedValue[$index].total" title="{{categorizedValue[$index].label.join(', ')}}">All</div>
                    </div>
                </div>
            </div>
            <div class="srSec">
                <div class="srSecTitle">KPI Filters</div>
                <div class="srFilterValues">
                    <div ng-repeat="cat in dimensions" class="srFilterBox clickable" ng-click="filtersModal(cat)" data-toggle="modal" data-target="#filterModal"  ng-if="addedFilters[cat.label]">
                        <div class="srFilterCat">{{cat.label}} <span class="srFilterSize">({{categorizedValue[$index].selected}}/{{categorizedValue[$index].total}})</span></div>
                        <div class="srFilterVal" ng-show="categorizedValue[$index].selected < categorizedValue[$index].total" data-toggle="tooltip" data-placement="bottom" title="{{categorizedValue[$index].label.join(', ')}}">{{categorizedValue[$index].label.join(', ')}}</div>
                        <div class="srFilterVal" ng-hide="categorizedValue[$index].selected < categorizedValue[$index].total" title="{{categorizedValue[$index].label.join(', ')}}">All</div>
                </div>
                </div>
            <div class="srSec">
                <div class="srSwitchTitle">Sync KPI with Spend</div>
                <span class="ms-switch btn-group"  ms-link-group selected-item="on" radio="true">
                    <button class="ms-switch-on btn btn-xs" ms-link="on">ON</button>
                    <button class="ms-switch-off btn btn-xs" ms-link="off">OFF</button>
                </span>
            </div>
            <div class="srSliderCollapse">
                <span class="clickable" ng-click="srShow = false; finishSaveAs(false);">
                    <icon type="chevron-up"></icon> Collapse
                </span>
            </div>
        </div>
    </section>

    <section class="results-panel">
        <h3 class="results-panel-title">KPI Summary</h3>
        <div class="result-panel-body well">
            <div class="row">
                <div class="kpi-container col-md-5ths col-xs-5ths" ng-repeat="kpiDatum in getKpiData()">
                    <h4 class="kpi-title">{{kpiDatum.title}}</h4>
                    <h2 class="kpi-incremental kpi-{{kpiDatum.direction}}">
                        <icon class="kpi-arrow" type="{{addArrow(kpiDatum.direction)}}"></icon>{{kpiDatum.incremental.current}}{{kpiDatum.incremental.number}}
                        <span class="kpi-unit">{{kpiDatum.incremental.unit}}</span>
                    </h2>
                    <span class="kpi-total">{{kpiDatum.total}}</span>
                    <span class="kpi-percent kpi-{{kpiDatum.direction}}">{{kpiDatum.percent}}</span>
                </div>
            </div>
        </div>
    </section>

    <section class="results-panel">
        <h3 class="results-panel-title">Spend Summary</h3>
        <div class="result-panel-body well">
            <div class="row">
                <div class="spend-container col-md-6 col-sm-6 col-xs-6">
                    <table class="spend-table">
                        <thead>
                            <tr ng-model="spendDatumHeader">
                                <th>{{spendDatumHeader.title}}</th>
                                <th>{{spendDatumHeader.total}}</th>
                                <th class="spend-{{spendDatumHeader.direction}}">{{spendDatumHeader.incremental}}</th>
                                <th class="spend-{{spendDatumHeader.direction}}">{{spendDatumHeader.percent}}</th>
                            </tr>
                        </thead>
                        <tbody ng-repeat="spendDatumBody in getSpendDataBody()">
                            <tr ng-repeat="spendDatumRow in spendDatumBody.children">
                                <td>{{spendDatumRow.title}}</td>
                                <td>{{spendDatumRow.total}}</td>
                                <td class="spend-{{spendDatumRow.direction}}">{{spendDatumRow.incremental}}</td>
                                <td class="spend-{{spendDatumRow.direction}}">{{spendDatumRow.percent}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="spend-container col-md-6 col-sm-6 col-xs-6">
                    <div class="legend">
                        <img src="images/legend.png" alt="legend">
                        <span>{{selectedView.title}} </span>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-6 chartContainer" ng-repeat="chartDatum in chartData">
                            <ms-bar-chart chart-data="chartDatum.data"></ms-bar-chart>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

</div>
