<form class="delete-and-filter form-inline">
    <div class="master-delete form-group" ng-controller="FileManagerDisplayCtrl">
        <label>
            <span ng-class="{'disabled': modelEnabled && 'master-delete' !== modelEnabled}">
                <a ng-click="dontPassEvent($event)" popover-title="Group Delete" popover-placement="left" mspopover="<popover-content id='master-delete' text='Are you sure you want to delete the {{filesToDeleteCount}} file(s)?' completedText='The file(s) has been successfully deleted.' completedTitle='Deleted!' callback='deleteFiles'></popover-content>"  popover-trigger="click" ><span group-delete></span></a>
            </span>
        </label>
    </div>

    <div class="pull-right select-menus" ng-controller="FileManagerDisplayCtrl">
        <div class="form-group filter-by">
            <label>Filter by: </label>
            <select class="form-control" ng-model="FilterService.filterBy" ng-options="item.filter as item.label for item in filterBy"></select>
        </div>

        <div class="form-group" >
            <label>Date Range: </label>
            <select class="form-control" ng-model="FilterService.dateRange" ng-options="item.filter as item.label for item in dateRange"></select>
      </div>
    </div>

    <div class="search-field" ng-controller="FileManagerSearchCtrl" >
        <div class="form-group search">
            <input type="text" class="form-control" placeholder="Search" name="srch-term" id="srch-term" ng-model="FilterService.searchText">
        </div>
    </div>
</form>

<sorter orderby="lastModified">
    <div class="panel panel-default file-manager-display" link-group ng-controller="FileManagerDisplayCtrl">
      <div class="panel-heading relative">
        <form class="form-inline sorting-bar plans" name="sorting-bar">
            <div class="checkbox">
                <tri-state-checkbox checkboxes="data.data"  class="select-all-cb" delete-service-for-checkbox></tri-state-checkbox>
            </div>

            <sorting-options label="title" display="Title"></sorting-options>
            <div class="pull-right">
                <sorting-options label="lastModified" display="Last Modified"></sorting-options>
                <sorting-options label="modifiedBy" display="Modified By"></sorting-options>
                <sorting-options label="fileType" display="File Type"></sorting-options>
            </div>
        </form>
      </div>

      <div class="panel-body relative no-padding">
        <div bindonce="item" ng-repeat="item in data.data | orderBy: orderBy : reverse | filter: FilterService.activeFilters | filter: FilterService.filterBy | filter: FilterService.searchText | dateRange : FilterService.dateRange" class="file-cell fade-in" ng-class="{selected: $index === selectedItem}" ng-click="toggleSelected($index)">
             <form class="form-inline relative categories">
                <div class="checkbox pull-left multi-select">
                    <input type="checkbox" ng-click="dontPassEvent($event)" ng-model="item.isSelected" />
                </div>
                <div class="symbol-holder">
                    <span ng-switch='item.masterSet'>
                        <span ng-switch-when='false' class="icon icon-{{item.icon}}"></span>
                        <span ng-switch-default class="icon icon-masterset"></span>
                    </span>
                </div>
                <h5 class="media-heading name"><a>{{item.title}}</a>&nbsp;
                    <span ng-class="{'disabled': modelEnabled && item.id !== modelEnabled}">
                        <a class="edit"  popover-title="Rename Entity" popover-placement="right" mspopover="<rename id='{{item.id}}'></rename>"  popover-trigger="click" ng-click="dontPassEvent($event)"><i class="icon-pencil"></i></a>
                    </span>
                </h5>
                <div class="pull-right">
                    <span class="lastModified heading" bo-text="item.lastModified | timeago"></span>
                    <span class="modifiedBy heading" bo-text="item.modifiedBy"></span>
                    <span class="fileType heading" bo-text="item.fileType"></span>
                </div>
            </form>
            <div class="text" bo-text="item.description"></div>

            <div class="hidden-content">
                <div class="dependency-count text">This entity is being used in <span bo-text="item.scenarios.length || 'no'"></span> scenarios. <a ng-click="toggleScenarioView($event)" ng-show="item.scenarios.length"><span bo-text='hideScenarios ? "Show" : "Hide"'></span> scenarios</a></div>
                <div class="text" >Created by: <span bo-text="item.createdBy"></span></div>
                <div class="text">Created On: <span bo-text="item.createdDate | date : fullDate"></span></div>

                <sorter orderBy="lastModified" ng-if="item.scenarios.length">
                    <div class="panel panel-default scenarios" ng-hide="hideScenarios">
                        <div class="no-scroll-bars sorting-bar">
                            <span class="symbol">   
                                <span class="file-type-icon">
                                  <span class='square red'>&nbsp;</span>
                                  <span class='square yellow'>&nbsp;</span>
                                  <span class='square green'>&nbsp;</span>
                                  <span class='square blue'>&nbsp;</span>
                                </span>
                            </span>
                            <sorting-options label="title" display="Title"></sorting-options>
                            <sorting-options label="lastModified" display="Last Modified"></sorting-options>
                            <sorting-options label="modifiedBy" display="Modified By"></sorting-options>
                            <sorting-options label="fileType" display="File Type"></sorting-options>
                        </div>
                        <div class="tableBody">
                            <div ng-repeat="scenario in item.scenarios | orderBy: orderBy : reverse">
                                <span class="symbol"><span class=" icon icon-{{scenario.icon}}"></span></span>
                                <span class="name" bo-text="scenario.title"></span>
                                <span class="lastModified" bo-text="scenario.lastModified | timeago"></span>
                                <span class="modifiedBy" bo-text="scenario.modifiedBy"></span>
                                <span class="fileType" bo-text="scenario.fileType"></span>
                            </div>
                        </div>
                    </div>
                </sorter>
            </div>
            <file-management-buttons></file-management-buttons>
        </div>
      </div>
    </div>
</sorter>
