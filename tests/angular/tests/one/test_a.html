<html>
<head>
	<title></title>
	<script src="angular.js"></script>
</head>
<body ng-app="myApp">

	<div ng-controller="MainCtrl">


		<test another></tes>

	</div>

	<script>
		var x = angular.module('myApp', []);
		x.controller('MainCtrl', function($scope){
			$scope.name = "Fred";
		})

		x.directive("test", function (){
			return{
				restrict: "AE",
				scope:{},
				template:"<div>Hello world {{name}} {{count}} <a ng-click='add()'>click</a></div><input ng-model='name' type='text' />",
				controller: function($scope, $element, $attrs){
					$scope.count = 0;
					$scope.add = function (){
						$scope.count++;
					}
					this.getCount = function (){
						return $scope.count;
					}
				}
			}
		});

		x.directive("another", function(){
			return {
				restrict: "AE",
				require:"?test",
				link: function (scope, element, attrs, ctrl){

					element.on('click', function (){console.info(ctrl.getCount()) })

					scope.$watch(ctrl.getCount, function(){
						console.info ("count has changed to " + ctrl.getCount());
					})

					scope.$watch('name', function(){
						console.info ("name has changed to " + scope.name);
					})
				}
			}
		})


	</script>

</body>
</html>